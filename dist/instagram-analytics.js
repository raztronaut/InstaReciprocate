var InstagramAnalytics;(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};(()=>{e.d(t,{default:()=>o});var n=function(e,t,n,s){return new(n||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function l(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}a((s=s.apply(e,t||[])).next())}))};class s{constructor(){this.container=null,this.startButton=null,this.progress=null,this.results=null,this.searchInput=null,this.isAnalyzing=!1,this.isUnfollowing=!1,this.unfollowCount=0,this.lastUnfollowTime=0,this.lastAnalyzed=null,this.service=null,this.selectedUsers=new Set,this.activeTab="non-followers",this.userMap=new Map,this.allUsers=[],this.unfollowedUsers=new Set,this.whitelistedUsers=this.loadWhitelistedUsers(),window.addEventListener("whitelistUpdated",(e=>{this.whitelistedUsers=new Set(e.detail.users),this.updateResults()}))}loadWhitelistedUsers(){try{const e=localStorage.getItem("instagram-analytics-whitelisted-users");return e?new Set(JSON.parse(e)):new Set}catch(e){return console.error("Error loading whitelisted users:",e),new Set}}saveWhitelistedUsers(){try{localStorage.setItem("instagram-analytics-whitelisted-users",JSON.stringify(Array.from(this.whitelistedUsers))),window.dispatchEvent(new CustomEvent("whitelistUpdated",{detail:{users:Array.from(this.whitelistedUsers)}}))}catch(e){console.error("Error saving whitelisted users:",e)}}toggleWhitelist(e){this.whitelistedUsers.has(e)?this.whitelistedUsers.delete(e):this.whitelistedUsers.add(e),this.saveWhitelistedUsers(),this.updateResults()}createUserItem(e){const t=document.createElement("div");t.className="user-item",t.dataset.username=e,t.style.cssText="\n      display: flex;\n      align-items: center;\n      padding: 12px;\n      border-radius: 8px;\n      margin: 4px 0;\n      transition: all 0.2s ease;\n      cursor: pointer;\n      background-color: transparent;\n      border: 1px solid #e5e7eb;\n    ";const s=document.createElement("div");if(s.style.cssText="display: flex; align-items: center; flex-grow: 1;","non-followers"===this.activeTab){const t=document.createElement("div");t.style.cssText=`\n        width: 20px;\n        height: 20px;\n        border-radius: 4px;\n        margin-right: 12px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s ease;\n        border: 2px solid ${this.selectedUsers.has(e)?"#3b82f6":"#d1d5db"};\n        background-color: ${this.selectedUsers.has(e)?"#3b82f6":"transparent"};\n      `,t.onclick=t=>{t.stopPropagation(),this.selectedUsers.has(e)?this.selectedUsers.delete(e):this.selectedUsers.add(e),this.updateResults()},this.selectedUsers.has(e)&&(t.innerHTML='\n          <svg class="w-3 h-3" viewBox="0 0 12 12" fill="none" stroke="white" stroke-width="2">\n            <path d="M2 6l3 3 5-5" />\n          </svg>\n        '),s.appendChild(t)}const o=document.createElement("div");o.style.cssText="\n      width: 44px;\n      height: 44px;\n      border-radius: 50%;\n      margin-right: 12px;\n      background-color: #f3f4f6;\n      overflow: hidden;\n      flex-shrink: 0;\n    ";const i=document.createElement("img");i.style.cssText="\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n    ",i.alt=`@${e}`;const r=this.userMap.get(e);i.src=(null==r?void 0:r.profilePicUrl)||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",i.onerror=()=>{i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="},o.appendChild(i),s.appendChild(o);const l=document.createElement("div");l.style.cssText="flex-grow: 1; min-width: 0;";const a=document.createElement("div");a.style.cssText="font-weight: 600; color: #262626; overflow: hidden; text-overflow: ellipsis; font-size: 14px;",a.textContent=e;const d=document.createElement("div");d.style.cssText="color: #737373; font-size: 14px; overflow: hidden; text-overflow: ellipsis; margin-top: 1px;",(null==r?void 0:r.fullName)?(d.textContent=r.fullName,l.appendChild(a),l.appendChild(d)):(a.style.marginTop="4px",l.appendChild(a)),s.appendChild(l);const c=document.createElement("button");return c.style.cssText="\n      background: none;\n      border: 1px solid #dbdbdb;\n      padding: 7px 16px;\n      border-radius: 8px;\n      font-size: 14px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      white-space: nowrap;\n    ","unfollowed"===this.activeTab?(c.textContent="Follow",c.style.color="white",c.style.background="#0095f6",c.style.border="none",c.onmouseover=()=>{c.style.background="#1aa1f7"},c.onmouseout=()=>{c.style.background="#0095f6"},c.onclick=t=>n(this,void 0,void 0,(function*(){t.stopPropagation(),this.unfollowedUsers.delete(e),this.updateResults()}))):"whitelist"===this.activeTab?(c.textContent="Protected",c.style.color="#16a34a",c.style.borderColor="#16a34a"):(c.textContent="Following",c.style.color="#262626",c.onmouseover=()=>{c.textContent="Unfollow",c.style.borderColor="#ef4444",c.style.color="#ef4444"},c.onmouseout=()=>{c.textContent="Following",c.style.borderColor="#dbdbdb",c.style.color="#262626"},c.onclick=t=>n(this,void 0,void 0,(function*(){t.stopPropagation();const n=this.userMap.get(e);n&&(c.disabled=!0,c.style.opacity="0.5",(yield this.unfollowUser(n.id))&&(this.unfollowedUsers.add(e),this.updateResults()),c.disabled=!1,c.style.opacity="1")}))),t.appendChild(s),t.appendChild(c),t}createTabs(){const e=document.createElement("div");e.style.cssText="\n      display: flex;\n      gap: 8px;\n      margin-bottom: 16px;\n    ";const t=(e,t,n)=>{const s=document.createElement("button");return s.style.cssText=`\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 14px;\n        font-weight: 500;\n        cursor: pointer;\n        border: none;\n        transition: all 0.2s ease;\n        ${this.activeTab===n?"background: #0095f6; color: white;":"background: #f3f4f6; color: #6b7280;"}\n      `,s.textContent=`${e} (${t})`,s.onclick=()=>this.switchTab(n),s},n=this.allUsers.filter((e=>!this.whitelistedUsers.has(e)&&!this.unfollowedUsers.has(e))).length;return e.appendChild(t("Users Not Following Back",n,"non-followers")),e.appendChild(t("Whitelist",this.whitelistedUsers.size,"whitelist")),e.appendChild(t("Unfollowed",this.unfollowedUsers.size,"unfollowed")),e}switchTab(e){this.activeTab=e,this.updateResults()}updateResults(){var e;if(!this.results)return;const t=document.getElementById("userList");if(!t)return;const n=(null===(e=this.searchInput)||void 0===e?void 0:e.value.toLowerCase())||"";let s;if(t.innerHTML="",s="whitelist"===this.activeTab?this.allUsers.filter((e=>this.whitelistedUsers.has(e))):"unfollowed"===this.activeTab?Array.from(this.unfollowedUsers):this.allUsers.filter((e=>!this.whitelistedUsers.has(e)&&!this.unfollowedUsers.has(e))),"non-followers"===this.activeTab){let e=document.querySelector(".action-buttons-container");e||(e=document.createElement("div"),e.className="action-buttons-container",t.parentElement&&t.parentElement.insertBefore(e,t)),e.innerHTML="",e.appendChild(this.createActionButtons())}else{const e=document.querySelector(".action-buttons-container");(null==e?void 0:e.parentElement)&&e.parentElement.removeChild(e)}let o=document.querySelector(".tabs-container");o||(o=document.createElement("div"),o.className="tabs-container",t.parentElement&&t.parentElement.insertBefore(o,t)),o.innerHTML="",o.appendChild(this.createTabs()),s.filter((e=>e.toLowerCase().includes(n))).forEach((e=>{t.appendChild(this.createUserItem(e))}))}initService(){return n(this,void 0,void 0,(function*(){if(!this.service){if(!document.cookie.match(/ds_user_id=(\d+)/))throw new Error("Not logged in");const e=document.cookie.match(/csrftoken=([^;]+)/);if(!e)throw new Error("No CSRF token found");this.service={getFollowing(t,s){return n(this,void 0,void 0,(function*(){var n,o,i;const r={id:t,include_reel:!1,fetch_mutual:!1,first:50,after:s},l=yield fetch(`https://www.instagram.com/graphql/query/?query_hash=3dec7e2c57367ef3da3d987d89f9dbc8&variables=${JSON.stringify(r)}`,{headers:{"content-type":"application/json","x-csrftoken":e[1],"x-ig-app-id":"936619743392459"},credentials:"include"});if(!l.ok)throw new Error(`API error: ${l.status}`);const a=yield l.json();if(!(null===(i=null===(o=null===(n=null==a?void 0:a.data)||void 0===n?void 0:n.user)||void 0===o?void 0:o.edge_follow)||void 0===i?void 0:i.edges))throw console.error("Invalid following response:",a),new Error("Invalid API response structure");return{users:a.data.user.edge_follow.edges.map((e=>e.node)),pageInfo:a.data.user.edge_follow.page_info}}))},getFollowers(t,s){return n(this,void 0,void 0,(function*(){var n,o,i;const r={id:t,include_reel:!1,fetch_mutual:!1,first:50,after:s},l=yield fetch(`https://www.instagram.com/graphql/query/?query_hash=5aefa9893005572d237da5068082d8d5&variables=${JSON.stringify(r)}`,{headers:{"content-type":"application/json","x-csrftoken":e[1],"x-ig-app-id":"936619743392459"},credentials:"include"});if(!l.ok)throw new Error(`API error: ${l.status}`);const a=yield l.json();if(!(null===(i=null===(o=null===(n=null==a?void 0:a.data)||void 0===n?void 0:n.user)||void 0===o?void 0:o.edge_followed_by)||void 0===i?void 0:i.edges))throw console.error("Invalid followers response:",a),new Error("Invalid API response structure");return{users:a.data.user.edge_followed_by.edges.map((e=>e.node)),pageInfo:a.data.user.edge_followed_by.page_info}}))}}}}))}createUI(){const e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.6);\n      z-index: 9998;\n      backdrop-filter: blur(8px);\n    ",this.container=document.createElement("div"),this.container.id="instagram-analytics-root",this.container.style.cssText='\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 560px;\n      max-height: 90vh;\n      background: white;\n      border-radius: 20px;\n      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.25);\n      z-index: 9999;\n      padding: 32px;\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n      overflow-y: auto;\n      border: 1px solid rgba(0, 0, 0, 0.1);\n    ';const t=document.createElement("div");t.style.cssText="\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 32px;\n      padding-bottom: 16px;\n      border-bottom: 1px solid #dbdbdb;\n    ";const n=document.createElement("div");n.style.cssText="\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    ";const s=document.createElement("div");s.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n      <path d="M12 2C14.717 2 15.056 2.01 16.122 2.06C17.187 2.11 17.912 2.277 18.55 2.525C19.21 2.779 19.766 3.123 20.322 3.678C20.8305 4.1779 21.224 4.78259 21.475 5.45C21.722 6.087 21.89 6.813 21.94 7.878C21.987 8.944 22 9.283 22 12C22 14.717 21.99 15.056 21.94 16.122C21.89 17.187 21.722 17.912 21.475 18.55C21.2247 19.2178 20.8311 19.8226 20.322 20.322C19.822 20.8303 19.2173 21.2238 18.55 21.475C17.913 21.722 17.187 21.89 16.122 21.94C15.056 21.987 14.717 22 12 22C9.283 22 8.944 21.99 7.878 21.94C6.813 21.89 6.088 21.722 5.45 21.475C4.78233 21.2245 4.17753 20.8309 3.678 20.322C3.16941 19.8222 2.77593 19.2175 2.525 18.55C2.277 17.913 2.11 17.187 2.06 16.122C2.013 15.056 2 14.717 2 12C2 9.283 2.01 8.944 2.06 7.878C2.11 6.812 2.277 6.088 2.525 5.45C2.77524 4.78218 3.1688 4.17732 3.678 3.678C4.17767 3.16923 4.78243 2.77573 5.45 2.525C6.088 2.277 6.812 2.11 7.878 2.06C8.944 2.013 9.283 2 12 2Z" stroke="#262626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="#262626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>';const o=document.createElement("h2");o.textContent="Instagram Analytics",o.style.cssText="\n      font-size: 20px;\n      font-weight: 600;\n      margin: 0;\n      color: #262626;\n    ",n.appendChild(s),n.appendChild(o);const i=document.createElement("button");i.innerHTML="âœ•",i.style.cssText="\n      background: none;\n      border: none;\n      font-size: 20px;\n      color: #8e8e8e;\n      cursor: pointer;\n      padding: 8px;\n      margin: -8px;\n      border-radius: 50%;\n      width: 32px;\n      height: 32px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.2s ease;\n    ",i.onmouseover=()=>{i.style.backgroundColor="#f3f4f6",i.style.color="#262626"},i.onmouseout=()=>{i.style.backgroundColor="transparent",i.style.color="#8e8e8e"},i.onclick=()=>{document.body.removeChild(e),document.body.removeChild(this.container)},t.appendChild(n),t.appendChild(i),this.startButton=document.createElement("button"),this.startButton.textContent="Start Analysis",this.startButton.style.cssText="\n      background: linear-gradient(45deg, #405DE6, #5B51D8, #833AB4, #C13584, #E1306C, #FD1D1D);\n      background-size: 400% 400%;\n      animation: gradient 15s ease infinite;\n      color: white;\n      border: none;\n      padding: 16px 24px;\n      border-radius: 14px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 16px;\n      width: 100%;\n      transition: all 0.3s ease;\n      position: relative;\n      overflow: hidden;\n    ";const r=document.createElement("style");r.textContent="\n      @keyframes gradient {\n        0% { background-position: 0% 50%; }\n        50% { background-position: 100% 50%; }\n        100% { background-position: 0% 50%; }\n      }\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n    ",document.head.appendChild(r),this.startButton.onmouseover=()=>{this.startButton.style.transform="translateY(-2px)",this.startButton.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.2)"},this.startButton.onmouseout=()=>{this.startButton.style.transform="translateY(0)",this.startButton.style.boxShadow="none"},this.progress=document.createElement("div"),this.progress.style.cssText="\n      margin-top: 24px;\n      padding: 20px;\n      background: #f3f4f6;\n      border-radius: 14px;\n      display: none;\n      font-size: 14px;\n      color: #262626;\n      text-align: center;\n    ",this.results=document.createElement("div"),this.results.style.cssText="margin-top: 24px;",this.container.appendChild(t),this.container.appendChild(this.startButton),this.container.appendChild(this.progress),this.container.appendChild(this.results),document.body.appendChild(e),document.body.appendChild(this.container),document.addEventListener("keydown",(t=>{"Escape"===t.key&&this.container&&document.body.contains(this.container)&&(document.body.removeChild(e),document.body.removeChild(this.container))})),this.startButton.addEventListener("click",(()=>this.analyze()))}createLoadingSpinner(){return'\n      <div style="\n        width: 20px;\n        height: 20px;\n        border: 2px solid #ffffff;\n        border-top-color: transparent;\n        border-radius: 50%;\n        display: inline-block;\n        animation: spin 1s linear infinite;\n        margin-right: 8px;\n        vertical-align: middle;\n      "></div>\n    '}formatNumber(e){return e.toLocaleString()}calculatePercentage(e,t){return Math.round(e/t*100)}createSearchInput(){const e=document.createElement("div");e.style.cssText="\n      margin: 16px 0;\n      position: relative;\n      width: 100%;\n      display: flex;\n    ";const t=document.createElement("div");return t.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); z-index: 1;">\n        <path d="M21 21L16.65 16.65M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="#8e8e8e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      </svg>\n    ',this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.placeholder="Search users...",this.searchInput.style.cssText="\n      width: 100%;\n      padding: 12px 12px 12px 40px;\n      border: 1px solid #dbdbdb;\n      border-radius: 8px;\n      font-size: 14px;\n      outline: none;\n      transition: all 0.2s ease;\n      box-sizing: border-box;\n    ",this.searchInput.onfocus=()=>{this.searchInput.style.borderColor="#0095f6"},this.searchInput.onblur=()=>{this.searchInput.style.borderColor="#dbdbdb"},e.appendChild(t),e.appendChild(this.searchInput),e.outerHTML}analyze(){return n(this,void 0,void 0,(function*(){var e;if(!this.isAnalyzing&&this.startButton&&this.progress&&this.results){this.isAnalyzing=!0,this.startButton.disabled=!0,this.startButton.style.opacity="0.8",this.startButton.style.cursor="not-allowed",this.startButton.innerHTML=`${this.createLoadingSpinner()}Analyzing...`,this.progress.style.display="block",this.results.innerHTML="";try{yield this.initService();const t=document.cookie.match(/ds_user_id=(\d+)/);if(!t)throw new Error("Not logged in");const n=t[1],s=new Set;let o,i=!0;for(;i;)try{yield new Promise((e=>setTimeout(e,2e3)));const e=yield this.service.getFollowing(n,o);e.users.forEach((e=>{s.add(e.username),this.userMap.set(e.username,{id:e.id,username:e.username,fullName:e.full_name||"",profilePicUrl:e.profile_pic_url||""})})),i=e.pageInfo.has_next_page,o=e.pageInfo.end_cursor,this.progress&&(this.progress.innerHTML=`\n              <div style="margin-bottom: 12px;">\n                <div style="font-weight: 600; margin-bottom: 8px;">Analyzing Following</div>\n                <div style="font-size: 24px; font-weight: 600; color: #262626;">\n                  ${this.formatNumber(s.size)}\n                </div>\n              </div>\n            `)}catch(e){console.error("Error fetching following:",e),i=!1}const r=new Set;let l,a=!0;for(;a;)try{yield new Promise((e=>setTimeout(e,2e3)));const e=yield this.service.getFollowers(n,l);e.users.forEach((e=>{r.add(e.username),this.userMap.has(e.username)||this.userMap.set(e.username,{id:e.id,username:e.username,fullName:e.full_name||"",profilePicUrl:e.profile_pic_url||""})})),a=e.pageInfo.has_next_page,l=e.pageInfo.end_cursor,this.progress&&(this.progress.innerHTML=`\n              <div style="margin-bottom: 12px;">\n                <div style="font-weight: 600; margin-bottom: 8px;">Analyzing Followers</div>\n                <div style="font-size: 24px; font-weight: 600; color: #262626;">\n                  ${this.formatNumber(r.size)}\n                </div>\n              </div>\n            `)}catch(e){console.error("Error fetching followers:",e),a=!1}this.allUsers=Array.from(s).filter((e=>!r.has(e)));const d=this.allUsers.filter((e=>!this.whitelistedUsers.has(e))).length,c=this.calculatePercentage(d,s.size);this.lastAnalyzed=new Date,this.results&&(this.results.innerHTML=`\n          <div style="background: #f3f4f6; border-radius: 16px; padding: 24px;">\n            <div style="font-size: 18px; font-weight: 600; color: #262626; margin-bottom: 20px;">Results</div>\n            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 28px;">\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Following</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(s.size)}</div>\n              </div>\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Followers</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(r.size)}</div>\n              </div>\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Not Following Back</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(d)}</div>\n                <div style="color: #8e8e8e; font-size: 12px; margin-top: 4px;">${c}% of following</div>\n              </div>\n            </div>\n            <div style="margin-top: 28px;">\n              <div class="tabs-container"></div>\n              ${this.createSearchInput()}\n              <div id="userList" style="max-height: 400px; overflow-y: auto; background: white; border-radius: 12px; padding: 8px;"></div>\n            </div>\n            <div style="margin-top: 16px; text-align: right; color: #8e8e8e; font-size: 12px;">\n              Last analyzed: ${null===(e=this.lastAnalyzed)||void 0===e?void 0:e.toLocaleString()}\n            </div>\n          </div>\n        `,this.updateResults(),this.searchInput&&this.searchInput.addEventListener("input",(()=>{this.updateResults()})))}catch(e){const t=e instanceof Error?e.message:"An unknown error occurred";this.results&&(this.results.innerHTML=`\n          <div style="\n            margin-top: 24px;\n            padding: 20px;\n            background: #ffebee;\n            border-radius: 12px;\n            color: #c62828;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n          ">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n              <path d="M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n            <div>\n              <div style="font-weight: 600; margin-bottom: 4px;">Error</div>\n              <div>${t}</div>\n            </div>\n          </div>\n        `)}finally{this.isAnalyzing=!1,this.startButton&&(this.startButton.disabled=!1,this.startButton.style.opacity="1",this.startButton.style.cursor="pointer",this.startButton.innerHTML="Start Analysis"),this.progress&&(this.progress.style.display="none")}}}))}unfollowUser(e){return n(this,void 0,void 0,(function*(){var t,n,s;try{const o=Date.now()-this.lastUnfollowTime,i=4e3*(1+.2*Math.random());if(o<i&&(yield new Promise((e=>setTimeout(e,i-o)))),this.unfollowCount>0&&this.unfollowCount%5==0){const e=document.createElement("div");e.className="text-blue-600 text-sm mt-2",e.textContent="Taking a 5-minute break to comply with rate limits...",null===(t=this.results)||void 0===t||t.appendChild(e),yield new Promise((e=>setTimeout(e,3e5))),null===(n=this.results)||void 0===n||n.removeChild(e)}const r=null===(s=document.cookie.match(/csrftoken=([^;]+)/))||void 0===s?void 0:s[1];if(!r)throw new Error("No CSRF token found");const l=yield fetch(`https://www.instagram.com/api/v1/friendships/destroy/${e}/`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded","x-csrftoken":r,"x-ig-app-id":"936619743392459","x-asbd-id":"198387","x-ig-www-claim":"0"},credentials:"include"});if(!l.ok)throw new Error(`Failed to unfollow user: ${l.status}`);return this.unfollowCount++,this.lastUnfollowTime=Date.now(),!0}catch(e){return console.error("Unfollow error:",e),!1}}))}unfollowSelected(){return n(this,void 0,void 0,(function*(){if(this.isUnfollowing||0===this.selectedUsers.size)return;this.isUnfollowing=!0;const e=this.selectedUsers.size;let t=0;const n=document.createElement("div");n.className="fixed bottom-4 right-4 bg-white p-4 rounded-lg shadow-lg z-50",n.innerHTML=`\n      <div class="flex items-center gap-4">\n        <div class="flex items-center gap-2">\n          <div class="relative h-5 w-5">\n            <div class="absolute inset-0 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"></div>\n          </div>\n          <span class="text-sm text-gray-600">\n            Unfollowing ${t}/${e}\n          </span>\n        </div>\n        <button id="cancelUnfollow" class="px-4 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-md hover:bg-red-100 transition-colors">\n          Cancel\n        </button>\n      </div>\n    `,document.body.appendChild(n);const s=()=>{const s=n.querySelector("span");s&&(s.textContent=`Unfollowing ${t}/${e}`)},o=document.getElementById("cancelUnfollow");o&&(o.onclick=()=>{this.isUnfollowing=!1,document.body.removeChild(n)});try{for(const e of this.selectedUsers){if(!this.isUnfollowing)break;const n=this.userMap.get(e);n?(yield this.unfollowUser(n.id))&&(t++,s(),this.selectedUsers.delete(e),this.updateResults()):console.error(`No user ID found for username: ${e}`)}}finally{this.isUnfollowing=!1,document.body.contains(n)&&document.body.removeChild(n)}}))}createActionButtons(){const e=document.createElement("div");e.style.cssText="\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      margin: 16px 0;\n      padding: 12px;\n      background: white;\n      border-radius: 8px;\n      border: 1px solid #dbdbdb;\n    ";const t=document.createElement("button");t.style.cssText="\n      padding: 7px 16px;\n      border-radius: 8px;\n      font-size: 14px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      background: none;\n      border: 1px solid #dbdbdb;\n      color: #262626;\n    ",t.textContent="Select All",t.onmouseover=()=>{t.style.backgroundColor="#f3f4f6"},t.onmouseout=()=>{t.style.backgroundColor="transparent"},t.onclick=()=>{const e=this.allUsers.filter((e=>!this.whitelistedUsers.has(e)&&!this.unfollowedUsers.has(e)));this.selectedUsers.size===e.length?(this.selectedUsers.clear(),t.textContent="Select All",t.style.backgroundColor="transparent",t.style.borderColor="#dbdbdb",t.style.color="#262626"):(this.selectedUsers=new Set(e),t.textContent="Deselect All",t.style.backgroundColor="#f3f4f6",t.style.borderColor="#d1d5db",t.style.color="#262626"),this.updateResults()};const n=document.createElement("button");return n.style.cssText=`\n      padding: 7px 16px;\n      border-radius: 8px;\n      font-size: 14px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      background: #0095f6;\n      border: none;\n      color: white;\n      opacity: ${0===this.selectedUsers.size?"0.5":"1"};\n      cursor: ${0===this.selectedUsers.size?"not-allowed":"pointer"};\n    `,n.textContent="Unfollow Selected",n.disabled=0===this.selectedUsers.size,n.onmouseover=()=>{n.disabled||(n.style.backgroundColor="#1aa1f7")},n.onmouseout=()=>{n.style.backgroundColor="#0095f6"},n.onclick=()=>{n.disabled||this.unfollowSelected()},e.appendChild(t),e.appendChild(n),e}init(){try{this.createUI()}catch(e){const t=e instanceof Error?e.message:"An unknown error occurred";console.error("Failed to inject Instagram Analytics:",t)}}}(new s).init();const o=s})(),InstagramAnalytics=t.default})();