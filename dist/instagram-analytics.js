var InstagramAnalytics;(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};(()=>{e.d(t,{default:()=>i});var n=function(e,t,n,s){return new(n||(n=Promise))((function(i,o){function r(e){try{l(s.next(e))}catch(e){o(e)}}function a(e){try{l(s.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((s=s.apply(e,t||[])).next())}))};class s{constructor(){this.container=null,this.startButton=null,this.progress=null,this.results=null,this.searchInput=null,this.isAnalyzing=!1,this.isUnfollowing=!1,this.unfollowCount=0,this.lastUnfollowTime=0,this.lastAnalyzed=null,this.service=null,this.selectedUsers=new Set,this.activeTab="non-followers",this.userMap=new Map,this.allUsers=[],this.whitelistedUsers=this.loadWhitelistedUsers(),window.addEventListener("whitelistUpdated",(e=>{this.whitelistedUsers=new Set(e.detail.users),this.updateResults()}))}loadWhitelistedUsers(){try{const e=localStorage.getItem("instagram-analytics-whitelisted-users");return e?new Set(JSON.parse(e)):new Set}catch(e){return console.error("Error loading whitelisted users:",e),new Set}}saveWhitelistedUsers(){try{localStorage.setItem("instagram-analytics-whitelisted-users",JSON.stringify(Array.from(this.whitelistedUsers))),window.dispatchEvent(new CustomEvent("whitelistUpdated",{detail:{users:Array.from(this.whitelistedUsers)}}))}catch(e){console.error("Error saving whitelisted users:",e)}}toggleWhitelist(e){this.whitelistedUsers.has(e)?this.whitelistedUsers.delete(e):this.whitelistedUsers.add(e),this.saveWhitelistedUsers(),this.updateResults()}createUserItem(e){const t=document.createElement("div");t.className="user-item",t.dataset.username=e,t.style.cssText=`\n      display: flex;\n      align-items: center;\n      padding: 12px;\n      border-radius: 8px;\n      margin: 4px 0;\n      transition: all 0.2s ease;\n      cursor: pointer;\n      background-color: ${this.whitelistedUsers.has(e)?"#f0fdf4":"transparent"};\n      border: 1px solid ${this.whitelistedUsers.has(e)?"#86efac":"#e5e7eb"};\n    `;const n=document.createElement("div");if(n.style.cssText="display: flex; align-items: center; flex-grow: 1;",!this.whitelistedUsers.has(e)&&"non-followers"===this.activeTab){const t=document.createElement("div");t.style.cssText=`\n        width: 20px;\n        height: 20px;\n        border-radius: 4px;\n        margin-right: 12px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s ease;\n        border: 2px solid ${this.selectedUsers.has(e)?"#3b82f6":"#d1d5db"};\n        background-color: ${this.selectedUsers.has(e)?"#3b82f6":"transparent"};\n      `,t.onclick=t=>{t.stopPropagation(),this.selectedUsers.has(e)?this.selectedUsers.delete(e):this.selectedUsers.add(e),this.updateResults()},this.selectedUsers.has(e)&&(t.innerHTML='\n          <svg class="w-3 h-3" viewBox="0 0 12 12" fill="none" stroke="white" stroke-width="2">\n            <path d="M2 6l3 3 5-5" />\n          </svg>\n        '),n.appendChild(t)}const s=document.createElement("div");s.style.cssText="\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      margin-right: 12px;\n      background-color: #f3f4f6;\n      overflow: hidden;\n      flex-shrink: 0;\n    ";const i=document.createElement("img");i.style.cssText="\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n    ",i.alt=`@${e}`,i.src=`https://i.instagram.com/api/v1/users/web_profile_info/?username=${e}`,i.onerror=()=>{i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="},s.appendChild(i),n.appendChild(s);const o=document.createElement("div");o.style.cssText="flex-grow: 1; min-width: 0;";const r=document.createElement("div");r.style.cssText="font-weight: 600; color: #262626; overflow: hidden; text-overflow: ellipsis;",r.textContent=`@${e}`,o.appendChild(r),n.appendChild(o);const a=document.createElement("div");a.style.cssText="display: flex; gap: 8px; align-items: center; flex-shrink: 0;";const l=document.createElement("button");l.style.cssText=`\n      background: ${this.whitelistedUsers.has(e)?"#dcfce7":"#f3f4f6"};\n      color: ${this.whitelistedUsers.has(e)?"#16a34a":"#6b7280"};\n      border: none;\n      padding: 8px 12px;\n      border-radius: 6px;\n      font-size: 14px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n      transition: all 0.2s ease;\n      white-space: nowrap;\n    `,l.innerHTML=`\n      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">\n        <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5l6.74-6.76z" />\n        <line x1="16" y1="8" x2="2" y2="22" />\n        <line x1="17.5" y1="15" x2="9" y2="15" />\n      </svg>\n      <span>${this.whitelistedUsers.has(e)?"Protected":"Protect"}</span>\n    `,l.onmouseover=()=>{l.style.backgroundColor=this.whitelistedUsers.has(e)?"#bbf7d0":"#e5e7eb"},l.onmouseout=()=>{l.style.backgroundColor=this.whitelistedUsers.has(e)?"#dcfce7":"#f3f4f6"},l.onclick=t=>{t.stopPropagation(),this.toggleWhitelist(e)};const d=document.createElement("button");return d.style.cssText="\n      background: none;\n      border: none;\n      padding: 8px;\n      color: #0095f6;\n      cursor: pointer;\n      font-size: 14px;\n      border-radius: 4px;\n      transition: all 0.2s ease;\n      flex-shrink: 0;\n    ",d.textContent="Copy",d.addEventListener("mouseover",(()=>{d.style.backgroundColor="#f3f4f6"})),d.addEventListener("mouseout",(()=>{d.style.backgroundColor="transparent"})),d.addEventListener("click",(t=>{t.stopPropagation(),navigator.clipboard.writeText(e);const n=d.textContent;d.textContent="Copied!",setTimeout((()=>{d.textContent=n}),2e3)})),a.appendChild(l),a.appendChild(d),t.appendChild(n),t.appendChild(a),t}createTabs(){const e=document.createElement("div");e.style.cssText="\n      display: flex;\n      gap: 8px;\n      margin-bottom: 16px;\n    ";const t=(e,t,n)=>{const s=document.createElement("button");return s.style.cssText=`\n        padding: 8px 16px;\n        border-radius: 8px;\n        font-size: 14px;\n        font-weight: 500;\n        cursor: pointer;\n        border: none;\n        transition: all 0.2s ease;\n        ${this.activeTab===n?"background: #0095f6; color: white;":"background: #f3f4f6; color: #6b7280;"}\n      `,s.textContent=`${e} (${t})`,s.onclick=()=>this.switchTab(n),s},n=this.allUsers.filter((e=>!this.whitelistedUsers.has(e))).length;return e.appendChild(t("Users Not Following Back",n,"non-followers")),e.appendChild(t("Whitelist",this.whitelistedUsers.size,"whitelist")),e}switchTab(e){this.activeTab=e,this.updateResults()}updateResults(){var e;if(!this.results)return;const t=document.getElementById("userList");if(!t)return;const n=(null===(e=this.searchInput)||void 0===e?void 0:e.value.toLowerCase())||"";t.innerHTML="";const s="whitelist"===this.activeTab?this.allUsers.filter((e=>this.whitelistedUsers.has(e))):this.allUsers.filter((e=>!this.whitelistedUsers.has(e)));if("non-followers"===this.activeTab){let e=document.querySelector(".action-buttons-container");e||(e=document.createElement("div"),e.className="action-buttons-container",t.parentElement&&t.parentElement.insertBefore(e,t)),e.innerHTML="",e.appendChild(this.createActionButtons())}let i=document.querySelector(".tabs-container");i||(i=document.createElement("div"),i.className="tabs-container",t.parentElement&&t.parentElement.insertBefore(i,t)),i.innerHTML="",i.appendChild(this.createTabs()),s.filter((e=>e.toLowerCase().includes(n))).forEach((e=>{t.appendChild(this.createUserItem(e))}))}initService(){return n(this,void 0,void 0,(function*(){if(!this.service){if(!document.cookie.match(/ds_user_id=(\d+)/))throw new Error("Not logged in");const e=document.cookie.match(/csrftoken=([^;]+)/);if(!e)throw new Error("No CSRF token found");this.service={getFollowing(t,s){return n(this,void 0,void 0,(function*(){var n,i,o;const r={id:t,include_reel:!1,fetch_mutual:!1,first:50,after:s},a=yield fetch(`https://www.instagram.com/graphql/query/?query_hash=3dec7e2c57367ef3da3d987d89f9dbc8&variables=${JSON.stringify(r)}`,{headers:{"content-type":"application/json","x-csrftoken":e[1],"x-ig-app-id":"936619743392459"},credentials:"include"});if(!a.ok)throw new Error(`API error: ${a.status}`);const l=yield a.json();if(!(null===(o=null===(i=null===(n=null==l?void 0:l.data)||void 0===n?void 0:n.user)||void 0===i?void 0:i.edge_follow)||void 0===o?void 0:o.edges))throw console.error("Invalid following response:",l),new Error("Invalid API response structure");return{users:l.data.user.edge_follow.edges.map((e=>e.node)),pageInfo:l.data.user.edge_follow.page_info}}))},getFollowers(t,s){return n(this,void 0,void 0,(function*(){var n,i,o;const r={id:t,include_reel:!1,fetch_mutual:!1,first:50,after:s},a=yield fetch(`https://www.instagram.com/graphql/query/?query_hash=5aefa9893005572d237da5068082d8d5&variables=${JSON.stringify(r)}`,{headers:{"content-type":"application/json","x-csrftoken":e[1],"x-ig-app-id":"936619743392459"},credentials:"include"});if(!a.ok)throw new Error(`API error: ${a.status}`);const l=yield a.json();if(!(null===(o=null===(i=null===(n=null==l?void 0:l.data)||void 0===n?void 0:n.user)||void 0===i?void 0:i.edge_followed_by)||void 0===o?void 0:o.edges))throw console.error("Invalid followers response:",l),new Error("Invalid API response structure");return{users:l.data.user.edge_followed_by.edges.map((e=>e.node)),pageInfo:l.data.user.edge_followed_by.page_info}}))}}}}))}createUI(){const e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.6);\n      z-index: 9998;\n      backdrop-filter: blur(8px);\n    ",this.container=document.createElement("div"),this.container.id="instagram-analytics-root",this.container.style.cssText='\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 560px;\n      max-height: 90vh;\n      background: white;\n      border-radius: 20px;\n      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.25);\n      z-index: 9999;\n      padding: 32px;\n      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n      overflow-y: auto;\n      border: 1px solid rgba(0, 0, 0, 0.1);\n    ';const t=document.createElement("div");t.style.cssText="\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 32px;\n      padding-bottom: 16px;\n      border-bottom: 1px solid #dbdbdb;\n    ";const n=document.createElement("div");n.style.cssText="\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    ";const s=document.createElement("div");s.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n      <path d="M12 2C14.717 2 15.056 2.01 16.122 2.06C17.187 2.11 17.912 2.277 18.55 2.525C19.21 2.779 19.766 3.123 20.322 3.678C20.8305 4.1779 21.224 4.78259 21.475 5.45C21.722 6.087 21.89 6.813 21.94 7.878C21.987 8.944 22 9.283 22 12C22 14.717 21.99 15.056 21.94 16.122C21.89 17.187 21.722 17.912 21.475 18.55C21.2247 19.2178 20.8311 19.8226 20.322 20.322C19.822 20.8303 19.2173 21.2238 18.55 21.475C17.913 21.722 17.187 21.89 16.122 21.94C15.056 21.987 14.717 22 12 22C9.283 22 8.944 21.99 7.878 21.94C6.813 21.89 6.088 21.722 5.45 21.475C4.78233 21.2245 4.17753 20.8309 3.678 20.322C3.16941 19.8222 2.77593 19.2175 2.525 18.55C2.277 17.913 2.11 17.187 2.06 16.122C2.013 15.056 2 14.717 2 12C2 9.283 2.01 8.944 2.06 7.878C2.11 6.812 2.277 6.088 2.525 5.45C2.77524 4.78218 3.1688 4.17732 3.678 3.678C4.17767 3.16923 4.78243 2.77573 5.45 2.525C6.088 2.277 6.812 2.11 7.878 2.06C8.944 2.013 9.283 2 12 2Z" stroke="#262626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="#262626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>';const i=document.createElement("h2");i.textContent="Instagram Analytics",i.style.cssText="\n      font-size: 20px;\n      font-weight: 600;\n      margin: 0;\n      color: #262626;\n    ",n.appendChild(s),n.appendChild(i);const o=document.createElement("button");o.innerHTML="✕",o.style.cssText="\n      background: none;\n      border: none;\n      font-size: 20px;\n      color: #8e8e8e;\n      cursor: pointer;\n      padding: 8px;\n      margin: -8px;\n      border-radius: 50%;\n      width: 32px;\n      height: 32px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.2s ease;\n    ",o.onmouseover=()=>{o.style.backgroundColor="#f3f4f6",o.style.color="#262626"},o.onmouseout=()=>{o.style.backgroundColor="transparent",o.style.color="#8e8e8e"},o.onclick=()=>{document.body.removeChild(e),document.body.removeChild(this.container)},t.appendChild(n),t.appendChild(o),this.startButton=document.createElement("button"),this.startButton.textContent="Start Analysis",this.startButton.style.cssText="\n      background: linear-gradient(45deg, #405DE6, #5B51D8, #833AB4, #C13584, #E1306C, #FD1D1D);\n      background-size: 400% 400%;\n      animation: gradient 15s ease infinite;\n      color: white;\n      border: none;\n      padding: 16px 24px;\n      border-radius: 14px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 16px;\n      width: 100%;\n      transition: all 0.3s ease;\n      position: relative;\n      overflow: hidden;\n    ";const r=document.createElement("style");r.textContent="\n      @keyframes gradient {\n        0% { background-position: 0% 50%; }\n        50% { background-position: 100% 50%; }\n        100% { background-position: 0% 50%; }\n      }\n      @keyframes spin {\n        to { transform: rotate(360deg); }\n      }\n    ",document.head.appendChild(r),this.startButton.onmouseover=()=>{this.startButton.style.transform="translateY(-2px)",this.startButton.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.2)"},this.startButton.onmouseout=()=>{this.startButton.style.transform="translateY(0)",this.startButton.style.boxShadow="none"},this.progress=document.createElement("div"),this.progress.style.cssText="\n      margin-top: 24px;\n      padding: 20px;\n      background: #f3f4f6;\n      border-radius: 14px;\n      display: none;\n      font-size: 14px;\n      color: #262626;\n      text-align: center;\n    ",this.results=document.createElement("div"),this.results.style.cssText="margin-top: 24px;",this.container.appendChild(t),this.container.appendChild(this.startButton),this.container.appendChild(this.progress),this.container.appendChild(this.results),document.body.appendChild(e),document.body.appendChild(this.container),document.addEventListener("keydown",(t=>{"Escape"===t.key&&this.container&&document.body.contains(this.container)&&(document.body.removeChild(e),document.body.removeChild(this.container))})),this.startButton.addEventListener("click",(()=>this.analyze()))}createLoadingSpinner(){return'\n      <div style="\n        width: 20px;\n        height: 20px;\n        border: 2px solid #ffffff;\n        border-top-color: transparent;\n        border-radius: 50%;\n        display: inline-block;\n        animation: spin 1s linear infinite;\n        margin-right: 8px;\n        vertical-align: middle;\n      "></div>\n    '}formatNumber(e){return e.toLocaleString()}calculatePercentage(e,t){return Math.round(e/t*100)}createSearchInput(){const e=document.createElement("div");e.style.cssText="\n      margin: 16px 0;\n      position: relative;\n      width: 100%;\n      display: flex;\n    ";const t=document.createElement("div");return t.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); z-index: 1;">\n        <path d="M21 21L16.65 16.65M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="#8e8e8e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      </svg>\n    ',this.searchInput=document.createElement("input"),this.searchInput.type="text",this.searchInput.placeholder="Search users...",this.searchInput.style.cssText="\n      width: 100%;\n      padding: 12px 12px 12px 40px;\n      border: 1px solid #dbdbdb;\n      border-radius: 8px;\n      font-size: 14px;\n      outline: none;\n      transition: all 0.2s ease;\n      box-sizing: border-box;\n    ",this.searchInput.onfocus=()=>{this.searchInput.style.borderColor="#0095f6"},this.searchInput.onblur=()=>{this.searchInput.style.borderColor="#dbdbdb"},e.appendChild(t),e.appendChild(this.searchInput),e.outerHTML}analyze(){return n(this,void 0,void 0,(function*(){var e;if(!this.isAnalyzing&&this.startButton&&this.progress&&this.results){this.isAnalyzing=!0,this.startButton.disabled=!0,this.startButton.style.opacity="0.8",this.startButton.style.cursor="not-allowed",this.startButton.innerHTML=`${this.createLoadingSpinner()}Analyzing...`,this.progress.style.display="block",this.results.innerHTML="";try{yield this.initService();const t=document.cookie.match(/ds_user_id=(\d+)/);if(!t)throw new Error("Not logged in");const n=t[1],s=new Set;let i,o=!0;for(;o;)try{yield new Promise((e=>setTimeout(e,2e3)));const e=yield this.service.getFollowing(n,i);e.users.forEach((e=>{s.add(e.username),this.userMap.set(e.username,{id:e.id,username:e.username})})),o=e.pageInfo.has_next_page,i=e.pageInfo.end_cursor,this.progress&&(this.progress.innerHTML=`\n              <div style="margin-bottom: 12px;">\n                <div style="font-weight: 600; margin-bottom: 8px;">Analyzing Following</div>\n                <div style="font-size: 24px; font-weight: 600; color: #262626;">\n                  ${this.formatNumber(s.size)}\n                </div>\n              </div>\n            `)}catch(e){console.error("Error fetching following:",e),o=!1}const r=new Set;let a,l=!0;for(;l;)try{yield new Promise((e=>setTimeout(e,2e3)));const e=yield this.service.getFollowers(n,a);e.users.forEach((e=>r.add(e.username))),l=e.pageInfo.has_next_page,a=e.pageInfo.end_cursor,this.progress&&(this.progress.innerHTML=`\n              <div style="margin-bottom: 12px;">\n                <div style="font-weight: 600; margin-bottom: 8px;">Analyzing Followers</div>\n                <div style="font-size: 24px; font-weight: 600; color: #262626;">\n                  ${this.formatNumber(r.size)}\n                </div>\n              </div>\n            `)}catch(e){console.error("Error fetching followers:",e),l=!1}this.allUsers=Array.from(s).filter((e=>!r.has(e)));const d=this.allUsers.filter((e=>!this.whitelistedUsers.has(e))).length,c=this.calculatePercentage(d,s.size);this.lastAnalyzed=new Date,this.results&&(this.results.innerHTML=`\n          <div style="background: #f3f4f6; border-radius: 16px; padding: 24px;">\n            <div style="font-size: 18px; font-weight: 600; color: #262626; margin-bottom: 20px;">Results</div>\n            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 28px;">\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Following</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(s.size)}</div>\n              </div>\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Followers</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(r.size)}</div>\n              </div>\n              <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">\n                <div style="color: #8e8e8e; font-size: 14px; margin-bottom: 8px;">Not Following Back</div>\n                <div style="font-size: 28px; font-weight: 600; color: #262626;">${this.formatNumber(d)}</div>\n                <div style="color: #8e8e8e; font-size: 12px; margin-top: 4px;">${c}% of following</div>\n              </div>\n            </div>\n            <div style="margin-top: 28px;">\n              <div class="tabs-container"></div>\n              ${this.createSearchInput()}\n              <div id="userList" style="max-height: 400px; overflow-y: auto; background: white; border-radius: 12px; padding: 8px;"></div>\n            </div>\n            <div style="margin-top: 16px; text-align: right; color: #8e8e8e; font-size: 12px;">\n              Last analyzed: ${null===(e=this.lastAnalyzed)||void 0===e?void 0:e.toLocaleString()}\n            </div>\n          </div>\n        `,this.updateResults(),this.searchInput&&this.searchInput.addEventListener("input",(()=>{this.updateResults()})))}catch(e){const t=e instanceof Error?e.message:"An unknown error occurred";this.results&&(this.results.innerHTML=`\n          <div style="\n            margin-top: 24px;\n            padding: 20px;\n            background: #ffebee;\n            border-radius: 12px;\n            color: #c62828;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n          ">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">\n              <path d="M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n            <div>\n              <div style="font-weight: 600; margin-bottom: 4px;">Error</div>\n              <div>${t}</div>\n            </div>\n          </div>\n        `)}finally{this.isAnalyzing=!1,this.startButton&&(this.startButton.disabled=!1,this.startButton.style.opacity="1",this.startButton.style.cursor="pointer",this.startButton.innerHTML="Start Analysis"),this.progress&&(this.progress.style.display="none")}}}))}unfollowUser(e){return n(this,void 0,void 0,(function*(){var t,n,s;try{const i=Date.now()-this.lastUnfollowTime,o=4e3*(1+.2*Math.random());if(i<o&&(yield new Promise((e=>setTimeout(e,o-i)))),this.unfollowCount>0&&this.unfollowCount%5==0){const e=document.createElement("div");e.className="text-blue-600 text-sm mt-2",e.textContent="Taking a 5-minute break to comply with rate limits...",null===(t=this.results)||void 0===t||t.appendChild(e),yield new Promise((e=>setTimeout(e,3e5))),null===(n=this.results)||void 0===n||n.removeChild(e)}const r=null===(s=document.cookie.match(/csrftoken=([^;]+)/))||void 0===s?void 0:s[1];if(!r)throw new Error("No CSRF token found");const a=yield fetch(`https://www.instagram.com/api/v1/friendships/destroy/${e}/`,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded","x-csrftoken":r,"x-ig-app-id":"936619743392459","x-asbd-id":"198387","x-ig-www-claim":"0"},credentials:"include"});if(!a.ok)throw new Error(`Failed to unfollow user: ${a.status}`);return this.unfollowCount++,this.lastUnfollowTime=Date.now(),!0}catch(e){return console.error("Unfollow error:",e),!1}}))}unfollowSelected(){return n(this,void 0,void 0,(function*(){if(this.isUnfollowing||0===this.selectedUsers.size)return;this.isUnfollowing=!0;const e=this.selectedUsers.size;let t=0;const n=document.createElement("div");n.className="fixed bottom-4 right-4 bg-white p-4 rounded-lg shadow-lg z-50",n.innerHTML=`\n      <div class="flex items-center gap-4">\n        <div class="flex items-center gap-2">\n          <div class="relative h-5 w-5">\n            <div class="absolute inset-0 rounded-full border-2 border-blue-500 border-t-transparent animate-spin"></div>\n          </div>\n          <span class="text-sm text-gray-600">\n            Unfollowing ${t}/${e}\n          </span>\n        </div>\n        <button id="cancelUnfollow" class="px-4 py-2 text-sm font-medium text-red-600 bg-red-50 rounded-md hover:bg-red-100 transition-colors">\n          Cancel\n        </button>\n      </div>\n    `,document.body.appendChild(n);const s=()=>{const s=n.querySelector("span");s&&(s.textContent=`Unfollowing ${t}/${e}`)},i=document.getElementById("cancelUnfollow");i&&(i.onclick=()=>{this.isUnfollowing=!1,document.body.removeChild(n)});try{for(const e of this.selectedUsers){if(!this.isUnfollowing)break;const n=this.userMap.get(e);n?(yield this.unfollowUser(n.id))&&(t++,s(),this.selectedUsers.delete(e),this.updateResults()):console.error(`No user ID found for username: ${e}`)}}finally{this.isUnfollowing=!1,document.body.contains(n)&&document.body.removeChild(n)}}))}createActionButtons(){const e=document.createElement("div");e.className="flex items-center gap-4 mb-4";const t=document.createElement("button");t.className="\n      px-4 py-2 rounded-md text-sm font-medium transition-all\n      bg-blue-50 text-blue-600 hover:bg-blue-100\n    ",t.textContent="Select All",t.onclick=()=>{const e=this.allUsers.filter((e=>!this.whitelistedUsers.has(e)));this.selectedUsers.size===e.length?(this.selectedUsers.clear(),t.textContent="Select All",t.className="px-4 py-2 rounded-md text-sm font-medium transition-all bg-blue-50 text-blue-600 hover:bg-blue-100"):(this.selectedUsers=new Set(e),t.textContent="Deselect All",t.className="px-4 py-2 rounded-md text-sm font-medium transition-all bg-gray-100 text-gray-600 hover:bg-gray-200"),this.updateResults()};const n=document.createElement("button");return n.className="\n      px-4 py-2 text-sm font-medium text-white bg-red-500 rounded-md \n      hover:bg-red-600 transition-colors\n      disabled:opacity-50 disabled:cursor-not-allowed\n    ",n.textContent="Unfollow Selected",n.onclick=()=>this.unfollowSelected(),e.appendChild(t),e.appendChild(n),e}init(){try{this.createUI()}catch(e){const t=e instanceof Error?e.message:"An unknown error occurred";console.error("Failed to inject Instagram Analytics:",t)}}}(new s).init();const i=s})(),InstagramAnalytics=t.default})();